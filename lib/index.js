// Generated by CoffeeScript 1.7.1
(function() {
  var app, argv, connect, createMiniHarp, makeJade, makeLess, reject, route, serveStatic;

  connect = require("connect");

  app = connect();

  argv = require("minimist")(process.argv.splice(2));

  serveStatic = require("serve-static");

  makeJade = require("../lib/processor/jade");

  makeLess = require("../lib/processor/less");

  route = require("../lib/processor/route");

  reject = require("../lib/processor/reject");

  createMiniHarp = function(root) {
    var port;
    port = argv.port || 4000;
    root = "verify/assets";
    console.log("miniHarp server is starting on " + port);
    return app.use(function(request, response, next) {
      var date;
      console.log(request.url);
      if (request.url === "/current-time") {
        date = (new Date()).toISOString();
        return response.end(date + "\n");
      } else {
        return next();
      }
    }).use(reject()).use(route()).use(serveStatic(root)).use(makeJade(root)).use(makeLess(root)).listen(port);
  };

  module.exports = createMiniHarp;

}).call(this);
